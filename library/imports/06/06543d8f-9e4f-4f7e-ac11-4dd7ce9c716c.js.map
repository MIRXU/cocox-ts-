{"version":3,"sources":["assets/scripts/star.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAsC,4BAAY;IAAlD;QAAA,qEA2CC;QAxCG,gBAAU,GAAQ,CAAC,CAAC,CAAA,mBAAmB;;IAwC3C,CAAC;IAtCG,wBAAwB;IAExB,yBAAM,GAAN;IAEA,CAAC;IAED,wBAAK,GAAL;IAEA,CAAC;IACD,YAAY;IACZ,kCAAe,GAAf;QACI,4BAA4B;QAC5B,IAAM,OAAO,GAAS,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;QACtF,OAAO;QACP,IAAM,GAAG,GAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC;QAChD,OAAO,GAAG,CAAC;IACf,CAAC;IACD,2BAAQ,GAAR;QACI,cAAc;QACd,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,YAAY,EAAE,CAAC;QAC1D,MAAM;QACN,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;QACvD,QAAQ;QACR,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,CAAC;IAED,yBAAM,GAAN,UAAQ,EAAE;QACN,kBAAkB;QAClB,IAAG,IAAI,CAAC,eAAe,EAAE,GAAC,IAAI,CAAC,UAAU,EAAC;YACtC,QAAQ;YACR,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,OAAO;SACV;QACD,oBAAoB;QACpB,IAAM,YAAY,GAAC,CAAC,GAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,KAAK,GAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;QAC9H,IAAM,UAAU,GAAC,EAAE,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,UAAU,GAAC,IAAI,CAAC,KAAK,CAAC,YAAY,GAAC,CAAC,GAAG,GAAC,UAAU,CAAC,CAAC,CAAC;IAC3E,CAAC;IAvCD;QADC,QAAQ;gDACW;IAHH,QAAQ;QAD5B,OAAO;OACa,QAAQ,CA2C5B;IAAD,eAAC;CA3CD,AA2CC,CA3CqC,EAAE,CAAC,SAAS,GA2CjD;kBA3CoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class NewClass extends cc.Component {\n\n    @property\n    pickRadius:number=0;//星星和主角距离小于当前值就收集星星\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\n    }\n\n    start () {\n      \n    }\n    //计算星星和玩家的距离\n    getPlayDistance():number{\n        //没有按照官网给的例子写，不知道什么原因，已经拿不到了\n        const playPos:cc.Vec3=this.node.getParent().getComponent('game').player.getPosition();\n        // 计算距离\n        const dis=this.node.position.sub(playPos).mag();\n        return dis;\n    }\n    onPicked(){\n        //星星被摘取，生成新的星星\n        this.node.getParent().getComponent('game').spawnNewStar();\n        //调用得分\n        this.node.getParent().getComponent('game').gainScore();\n        //销毁当前星星\n        this.node.destroy();\n    }\n\n    update (dt) {\n        //如果当前距离小于收集距离，就收取\n        if(this.getPlayDistance()<this.pickRadius){\n            //  收取星星\n            this.onPicked();\n            return;\n        }\n        //根据game脚本计时器更新星星透明度\n        const opacityRatio=1-this.node.getParent().getComponent('game').timer/this.node.getParent().getComponent('game').starDuration;\n        const minOpacity=50;\n        this.node.opacity=minOpacity+Math.floor(opacityRatio*(255-minOpacity));\n    }\n}\n"]}