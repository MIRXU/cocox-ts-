{"version":3,"sources":["assets/scripts/game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class NewClass extends cc.Component {\n\n   //引入星星预制体\n    @property(cc.Prefab)\n    starPrefab:cc.Prefab=null;\n\n    //星星产生后消失时间的随机范围\n    @property\n    maxStarDuration:number=0;\n    @property\n    minStarDuration:number=0;\n\n    //地面\n    @property(cc.Node)\n    ground:cc.Node=null;\n\n    //玩家\n    @property(cc.Node)\n    player:cc.Node=null;\n\n    @property({visible:false})\n    @property\n    groundY:number=0;\n\n    //得分\n    @property(cc.Label)\n    scoreDisplay:cc.Label=null;\n    // LIFE-CYCLE CALLBACKS:\n    //初始化得分\n    @property({visible:false})\n    score:number=0;\n\n\n    // 初始化计时器\n    @property({visible:false})\n    timer:number=0;\n    @property({visible:false})\n    starDuration:number=0;\n\n    //得分音效\n    @property(cc.AudioClip)\n    scoreAudio:cc.AudioClip=null;\n    onLoad () {\n        //获取地面y轴\n        this.groundY=this.ground.y+this.ground.height/2;\n        //生成星星\n        this.spawnNewStar();\n    }\n    spawnNewStar():void{\n        //内置方法生成星星\n        const newStar=cc.instantiate(this.starPrefab);\n        //将星星添加至场景\n        this.node.addChild(newStar);\n        //设置星星随机点\n        newStar.setPosition(this.getNewStarPosition());\n        newStar.getComponent('star').game=this;//星星脚本保存game 对象的引用\n        //根据消失时间，重置计时器\n        this.starDuration=this.minStarDuration+Math.random()*(this.maxStarDuration-this.minStarDuration);\n        this.timer=0;\n    }\n    getNewStarPosition():cc.Vec2{\n        let randX:number=0;\n        //根据地面和主角跳跃高度，随机生成星星y坐标\n        const randY=this.groundY+Math.random()*this.player.getComponent('Player').jumpHeight+50;\n        // 根据屏幕宽度获取星星的x\n        const maxX=this.node.width/2;\n        randX=(Math.random()-0.5)*2*maxX;\n\n        return cc.v2(randX,randY);\n    }\n    gainScore():void{\n        this.score+=1;\n        this.scoreDisplay.string=`Score:${this.score}`;\n        //播放得分音效\n        cc.audioEngine.playEffect(this.scoreAudio,false);\n    }\n    start () {\n\n    }\n\n    update (dt) {\n        if(this.timer>this.starDuration){\n            this.gameOver();\n            return;\n        }\n        this.timer+=dt;\n    }\n    gameOver():void{\n        // 停止跳跃\n        this.player.stopAllActions();\n        //重新加载场景\n        cc.director.loadScene('game');\n    }\n}\n"]}